# 盗币的可能性


正如前面邮件所陈述的那样，比特币采用非对称加密技术的公钥和私钥作为接受和认可比特币作为支付工具的机制。然而，中本聪决定使用公钥的哈希而不是公钥本身来作为比特币的地址。中本聪这么做有两个原因：1.因为哈希仅有160比特的位长，这样减小了每笔交易的事务大小；2.可以方便地添加一层安全性，以防有一天在比特币使用的非对称加密算法中发现“后门”或安全漏洞。为了能够使用比特币，黑客必须首先从哈希中派生公钥，然后从公钥中派生私钥。 关于这个话题，[比特币杂志](https://bitcoinmagazine.com/articles/satoshis-genius-unexpected-ways-in-which-bitcoin-dodged-some-cryptographic-bullet-1382996984/)上有一篇优秀的文章。

一个拥有大量算力的攻击者将存储在比特币地址中比特币进行支付的可能性是多少？这是这篇文章的主要脉络。由于比特币区块链是一个开放式分类账簿，因此可以观察到一个比特币地址是否具有大量金额，最终攻击者会选择这些地址进行攻击。

中本聪认为，这这样的攻击成功将是非常困难的。因为它需要暴力攻击才能找到与哈希匹配的公钥。它同时也证明了开源代码在安全方面的价值，这与封闭源代码相反。
中本聪的整个帖子包含了这些思路的主要部分，内容如下：

<br />

> 发布者Red，2010年7月25日，下午05:08:03
> ————————————————————————————————————————————————————
> 我认为目前的比特币存在一个非常重要的加密漏洞。我不确定它现在是否可以被利用(我不是一个真正的加密黑客)，但它在不久的将来极可能被利用。
>
> 该漏洞能够让匿名者随意的窃取比特币地址上的币，并且不用解决现有加密系统里的任何难题。它只是实现中潜在的可纠正的逻辑缺陷。
>
> 我希望比特币能够成功，所以我不愿在公共场合大肆宣扬它的瑕疵，是否有适当的地方可以讨论这些类型的问题？

<br />

> **发布者中本聪，2010年7月25日，下午05:45:22**
> ————————————————————————————————————————————————————
> **最好是私下告诉我，以便先修复它。**
> 
> **我刚给你发了一封电子邮件地址。(或者你可以在这里联系我)**

<br />

> **发布者中本聪，2010年7月25日，下午07:06:23**
> ————————————————————————————————————————————————————
> **Red，谢谢你首先私下告诉我！请继续发布(并为所有人解除悬念！)**
>
> **Red的观点是，支付给比特币地址的交易只能与哈希函数一样安全。为了缩短比特币地址，它们是公钥的哈希，而不是公钥本身。攻击者紧紧破解了哈希函数，而不是ECDSA。**

<br />

> 发布者Red，2010年7月25日，下午07:09:43
> ————————————————————————————————————————————————————
> 谢谢中本聪，下面这些是我发给中本聪的邮件内容。
>
> ————————
>
> 公钥加密取决于很难计算的大质数。每个人都知道，如果比特币转移被分配到良好的公钥，并且未来转移需要相关的私钥签名，我会承认比特币加密转移是完全安全的。
> 
> 但是，比特币交易似乎没有那种工作，交易将币分配给特定的“比特币地址”，其中地址是公钥的哈希值。
>
> 为了验证交易，节点从签名中获取公钥并使用它来验证实际签名。如果签名有效，则会哈希公钥以进行确认它匹配上一个交易中分配的比特币地址。如果两者都匹配，根据定义，交易是好的。
> 
> 潜在的弱点在于将签名中的公钥与比特币地址相关联。
>
> 公钥和给定哈希之间存在多对一关系。现在，如果找到一对质数创建一个安全的公钥/私钥对，公钥部分哈希到特定的比特币地址似乎很难...它可能就是这样。
>
> 但是，这不是必需的。
>
> 你所需要的是代表一个公钥的哈希与一个已知的大比特币账户相撞。它不一定是基于素数的安全密钥对。它只需要工作一次，并允许将被盗资金转移到另一个帐户。这可能会容易得多。
> 
> 有些哈希比其他哈希更难碰撞。我不确定正在使用的哈希的强度。但是，如果您不关心正在哈希的内容，则任何哈希的碰撞都会变得容易。
> 
> 由于公钥的性质，看起来像随机数。据我所知，除非你成功地将公钥用于保护，否则你无法知道公钥基于的数学是否安全。因此客户不要尝试，他们通常只是对签名进行验证，并假定公钥是以安全的方式生成的。
> 
> 由于公钥的性质，看起来像随机数。据我所知，除非你成功地将公钥用于保护，否则你无法知道公钥基于的数学是否安全。因此客户不要尝试，他们通常只是对签名进行验证，并假定公钥是以安全的方式生成的。
>
> 注意：以下分析需要由真正的加密黑客进行双重检查。
>
> 由于公钥的性质，看起来像随机数。据我所知，除非你成功地将公钥用于保护，否则你无法知道公钥基于的数学是否安全。因此客户不要尝试，他们通常只是对签名进行验证，并假定公钥是以安全的方式生成的。
> 因此，根据哈希值，您可以使用其中一种即将到来的哈希碰撞算法来生成表示公钥的碰撞的数据块。通过公钥/私钥的数学逆向，生成一个相联系的私钥将会是有效的签名（但几乎不安全）。
> 
> 然后，您可以使用不安全，易于理解的密钥对，并生成与目标比特币地址匹配的已签名交易。
>
> 由于交易的日志，无法验证币符合完整的公钥，因此简单地假定它必须是所呈现的那个。
>
> 通过在阻止列表中记录传输目标的完整公钥，您可以重新获得预期的强度。但是，您失去了传递34个字符地址的能力。
>
> 如果我远离的基本的内容，我为浪费你的时间而道歉。
>
> Red

<br />

> 发布者Red，2010年7月25日，下午07:22:14
> ————————————————————————————————————————————————————
> 中本聪指出我的方案仍然需要破坏哈希函数。这是事实，但我很惊讶地发现有些人已经取得了成功。 MD4和MD5是明显的例子。但是在SHA-1和SHA-256这样的兄弟姐妹之间的碰撞正在顺利进行。
>
> 在比特币里面使用了什么哈希？
> 
> 他也怀疑你能不能使用生成的密钥对以外的其他东西。
>
> 在这一点上，我非常有信心这是一个简单的数学问题。在我了解到“盲目签署”文件之前，我没有对此给予足够的重视。
>
> 事实证明，你可以拿一份文件并将其乘以一个随机数，然后有人签署混乱文件。最后，将您的随机数除以其签名，结果仍然是原始文档的有效签名。谁想到那会起作用！
>
> 无论如何，如果密钥对只是基于成对的素数，那么它们是安全的。如果数字不是素数，那么任何数学都不会改变。它们更易于考虑分解。
> 
> 我会非常高兴一些加密家伙证明我是个白痴。它会影响我以前创建项目的某些功能，这些功能依赖于相同的关联。我当时也没有想到这一点。

<br />

> 发布者 knightmb，2010年7月25日，下午07:34:42
> ————————————————————————————————————————————————————
> 非常好。 我喜欢开源的另一个原因
> 据我所知，如果我错了，请纠正我。由于公钥的哈希小于实际的公钥本身，因此只需找到与哈希匹配的碰撞，并且当发生碰撞时，您将知道公钥/私钥组合。然后你只需使用已知币进行支付，其他客户会认为这是一个有效的转移，因为客户只关心你的哈希匹配受害者的哈希并且所有时间交易都被记录。
> 
> 目前哈希长度为35个字符，字母数字26(大写)+26(小写)+10(数字) = 每个字符可能62个。
> 
> 因此，我们有541,638,008,296,341,754,635,824,011,376,225,346,986,572,413,939,634,062,667,808,768种可能的组合。
>
> 所以我认为与对主私钥/公钥进行暴力破解相比，我们有大约一半的工作要做。 永远不要伤害未来的计划： 

<br />

> 发布者 knightmb，2010年7月25日，下午07:44:02
> ————————————————————————————————————————————————————
> &emsp;&emsp; 引自：Red, 2010年7月25日，下午07:22:14
> 
> &emsp;&emsp; 中本聪指出我的方案仍然需要破坏哈希函数。这是事实，但我很惊讶地发现有些人已经取得了成功。 MD4和MD5是明显的例子。但是在SHA-1和SHA-256这样的兄弟姐妹之间的碰撞正在顺利进行。
> 
> &emsp;&emsp; ——————————————————————————————————————————————————
> 他们经常没有提到的是**碰撞的生成**仍然需要花费大量的CPU时间。如果我发现公钥123456生成哈希为ABCD，公钥654321生成的哈希也为ABCD。
>
> 我仍得不到私钥。
>
> 但是根据你所说的，我所需要的只是公钥654321，我可以假装成公钥123456来支付币。

<br />

> 发布者Red，2010年7月25日，下午07:52:23
> ————————————————————————————————————————————————————
> 据我所知，比特币正在使用160位比特的哈希来生成比特币地址。
>
> SHA-1系列哈希算法是最常用的一些。 SHA-1是160位哈希。
> 这是一篇声称在2^52次加密操作中发现SHA-1碰撞的[论文](http://www.ictlex.net/wp-content/iacrhash.pdf)。最安全的哈希将需要2^80次操作。尽管2^52次很大，但它正在进入集群和僵尸网络的范围。
> 
> MD5哈希在笔记本电脑上已经可以在几秒钟内发生碰撞，这就是为什么它从基于证书的签名中退出的原因。
>
> 是的，我所说的是**我认为**你可以将公钥视为两个以数学方式组合在一起的秘密数字。而私钥作为这两个数字分开保存。使系统安全的事情要求两个秘密数字实际上是大质数。
> 
> 但是如果它们真的很大非素数，组合数学仍然有效，仅仅是更快的破解了算法。
>
> 我会进一步做一些搜索，看看是否可以证实我的主张。我也希望有人可以驳回它们。

<br />

> **发布者中本聪，2010年7月25日，下午08:01:40**
> ————————————————————————————————————————————————————
> &emsp;&emsp; 引自：Knightmb, 2010年7月25日，下午07:44:02
>
> &emsp;&emsp; 如果我发现公钥123456生成哈希为ABCD，公钥654321生成的哈希也为ABCD。
>
> &emsp;&emsp; 我仍得不到私钥。
>
> &emsp;&emsp; 但是根据你所说的，我所需要的只是公钥654321，我可以假装成公钥123456来支付币。
>
> &emsp;&emsp; ——————————————————————————————————————————————————
> **您仍然需要使用公钥654321对其进行签名。您需要使用您知道私钥的公钥来寻找碰撞。**
> 
> **当您声明比特币地址进行交易时，您提供与哈希匹配的公钥，然后您必须使用该密钥对其进行签名。**
>
> **Red的观点是，很容易快速生成不安全的公钥，在发现碰撞后你可以破解并找到私钥。**
> 
> **他指出，如果公钥必须是一个安全的公钥，那一个必须要求大量工作才能找到这个素数，这将增加哈希函数的强度。试图暴力的人必须花时间为每次尝试生成一个密钥。**

<br />


> 发布者 knightmb，2010年7月25日，下午08:20:41
> ————————————————————————————————————————————————————
> &emsp;&emsp; 引自：中本聪, 2010年7月25日，下午08:01:40 
>
> &emsp;&emsp; 您仍然需要使用公钥654321对其进行签名。您需要使用您知道私钥的公钥来寻找碰撞。
> 
> &emsp;&emsp; 当您声明比特币地址进行交易时，您提供与哈希匹配的公钥，然后您必须使用该密钥对其进行签名。
>
> &emsp;&emsp; Red的观点是，很容易快速生成不安全的公钥，在发现碰撞后你可以破解并找到私钥。
> 
> &emsp;&emsp; 他指出，如果公钥必须是一个安全的公钥，那一个必须要求大量工作才能找到这个素数，这将增加哈希函数的强度。试图暴力的人必须花时间为每次尝试生成一个密钥。
> &emsp;&emsp; ————————————————————————————————————————————————————
> 是的，我认为私钥必须在某处混合。它增加了另一种随机性，你必须找到与另一个公钥冲突的哈希，同时，私钥必须足够弱才能破解。我不是说这是不可能的，但它在反向碰撞发现中引入了2个变量。
>
> 基本上，人们会构建一个弱私钥的彩虹表，然后必须将它们与公钥哈希进行比较，然后不得不希望那里的某个人有一个恰好是该攻击的一部分。 当然不是不可能的，但即使计算机在10年内速度提高了100倍，可行吗？
>
> [编辑]好的，重新阅读你写的内容，公钥是从私钥生成的，而不是独立生成的。 因此，只需找到一个弱的公钥即可。

<br />

> **发布者中本聪，2010年7月25日，下午08:48:01**
> —————————————————————————————————————————————————————
> &emsp;&emsp; 引用
> &emsp;&emsp; 这是一篇声称在2^52次加密操作中发现了SHA-1碰撞的论文。最安全的哈希需要2^80次操作，2^52次仍然很大，但它正在进入集群和僵尸网络范围。
>
> &emsp;&emsp; ————————————————————————————————————————————————————
> **2^80是你可以使用的生日攻击。你不能使用生日攻击，所以难度是2^160。虽然，如果你试图破解100万(2^20)个交易中的任何一个，你可以做部分生日攻击2^ 160/2^20=2^140。**
>
> **比特币地址是唯一使用160位哈希的地方，其他都是SHA-256。他们的计算如下：**
>
> > **bitcoinaddress = RIPEMD-160(SHA-256(publickey))**
>
> **如果我错了，请纠正我(恳请，我很乐意吃乌鸦)。但我认为在这种情况下使用RIPEMD-160很难进行分析攻击。分析攻击规定了一定的范围或模式尝试的输入会大大增加你发现碰撞的几率。在这里，您没有对RIPEMD-160输入的这种控制，因为输入是SHA-256的输出。如果分析攻击可以帮助您找到产生碰撞的RIPEMD-160输入，那么您打算用它做什么？你仍然必须得到SHA-256输出该值，所以你仍然必须打破SHA-256。**
>
> **对于暴力破解，RIPEMD-160(SHA-256(x))并不比单独的RIPEMD-160强。但是对于分析攻击，似乎你必须分析攻击RIPEMD-160和SHA-256。如果我错了，那么强度与RIPEMD-160相同，而SHA-256仅用作一轮增强密钥。**

<br />

> 发布者Red，2010年7月25日，下午09:04:01
> —————————————————————————————————————————————————————
>
> &emsp;&emsp 引用自：中本聪，2010年7月25日，下午08:48:01
> 
> &emsp;&emsp; bitcoinaddress = RIPEMD-160(SHA-256(publickey))
>
> &emsp;&emsp; 如果我错了，请纠正我(恳请，我很乐意吃乌鸦)。但我认为在这种情况下使用RIPEMD-160很难分析攻击。
>
> &emsp;&emsp; ————————————————————————————————————————————————————
> 我认为你对分析攻击是正确的。 至少就我所了解的数学天才是那样分析的。
> 
> 我担心它可能太简单了：bitcoinaddress = RIPEMD-160（publickey）
>
>
>
>
>
>

